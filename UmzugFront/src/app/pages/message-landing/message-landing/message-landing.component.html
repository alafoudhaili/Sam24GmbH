<app-breadcrumbs title="Nachrichtenliste" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header">
                <h4 class="card-title mb-0">Liste der Nachrichten</h4>
            </div><!-- end card header -->

            <div class="card-body">
                <div class="table mt-3 mb-1">
                    <div class="table-responsive">
                        <table class="table table-bordered table-sm">
                            <thead>
                            <tr class="bg-light text-muted">
                                <th class="small-text nowrap">Datum</th>
                                <th class="small-text nowrap">Name und Vorname</th>
                                <th class="small-text nowrap">E-Mail</th>
                                <th class="small-text nowrap">Telefon</th>
                                <th class="small-text nowrap">Nachricht</th>
                                <th class="small-text nowrap">Status</th>
                                <th class="actions-header small-text">AKTIONEN</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr *ngFor="let message of messages">
                                <td class="small-text nowrap">{{ message.date | date:"dd-MM-yyyy HH:mm" }}</td>
                                <td class="small-text nowrap">{{ message.nom }}</td>
                                <td class="small-text nowrap">{{ message.email }}</td>
                                <td class="small-text nowrap">{{ message.telephone ? message.telephone : "kein Telefon" }}</td>
                                <td class="small-text nowrap">{{ message.message }}</td>
                                <td class="small-text nowrap">
                                    <div class="status-box" [ngClass]="{'bg-success': message.lu === 'lu', 'bg-danger': message.lu === 'non-lu'}">
                                        {{ message.lu }}
                                    </div>
                                </td>
                                <td class="small-text nowrap" style="display: flex; justify-content: space-around;">
                                    <a data-bs-trigger="hover" ngbTooltip="Details" placement="top" data-bs-toggle="modal" class="text-primary d-inline-block edit-item-btn" data-bs-target="#showDetail" (click)="showDetails(showDetail,message)">
                                        <i class="ri-eye-fill fs-16"></i>
                                    </a>
                                    <a ngbTooltip="Löschen" placement="top" data-bs-trigger="hover" class="text-danger d-inline-block remove-item-btn" data-bs-toggle="modal" data-bs-target="#deleteOrder" (click)="confirm(deleteModel, message.id_message_landing)">
                                        <i class="ri-delete-bin-5-fill fs-16"></i>
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="d-flex justify-content-end">
                    <ngb-pagination
                            [collectionSize]="length"
                            [(page)]="currentPage"
                            [pageSize]="itemsPerPage"
                            [maxSize]="20"
                            [rotate]="true"
                            (pageChange)="pageChanged($event)"
                    ></ngb-pagination>
                </div>
            </div><!-- end card-body -->
        </div><!-- end card -->
    </div><!-- end col -->
</div><!-- end row -->

<ng-template #showDetail let-modal>
    <div class="modal-content d-flex justify-content-center align-items-center" style="height: 100%;">
        <div class="modal-header">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                    (click)="modal.dismiss('Cross click')"></button>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col">
                    <strong>Name: </strong>  {{ messageLandingDetaille ? messageLandingDetaille.nom : 'Kein Name' }} <br>
                    <strong>E-Mail: </strong> {{ messageLandingDetaille ? messageLandingDetaille.email : 'Keine E-Mail' }} <br>
                    <strong>Telefon: </strong>  {{ messageLandingDetaille ? messageLandingDetaille.telephone : 'Kein Telefon' }} <br>
                    <strong>Betreff: </strong>  {{ messageLandingDetaille ? messageLandingDetaille.objet : 'Kein Betreff' }} <br>
                    <hr>
                    <strong>Nachricht: </strong> <br>
                    <div class="message-body" [innerHTML]="messageLandingDetaille ? messageLandingDetaille.message : 'Keine Nachricht'"></div>
                </div>
            </div>
        </div>
    </div><!-- /.modal-content -->
</ng-template>

<ng-template #deleteModel let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                    (click)="modal.dismiss('Cross click')"></button>
        </div>
        <div class="modal-body">
            <div class="mt-2 text-center">
                <lord-icon src="https://cdn.lordicon.com/gsqxdxog.json" trigger="loop"
                           colors="primary:#405189,secondary:#f06548" style="width:90px;height:90px"></lord-icon>
                <div class="mt-4 pt-2 fs-15 mx-4 mx-sm-5">
                    <h4>Möchten Sie diese Nachricht wirklich löschen?</h4>
                    <p class="text-muted mx-4 mb-0">Diese Aktion wird die Nachricht endgültig löschen.</p>
                </div>
            </div>
            <div class="d-flex gap-2 justify-content-center mt-4 mb-2">
                <button type="button" class="btn w-sm btn-success" ngbTooltip="Abbrechen" data-bs-trigger="hover"
                        (click)="modal.close('Close click')">Abbrechen
                </button>
                <button type="button" class="btn w-sm btn-danger " id="delete-product"
                        (click)="deleteMessage()">Ja, löschen!
                </button>
            </div>
        </div>
    </div><!-- /.modal-content -->
</ng-template>
